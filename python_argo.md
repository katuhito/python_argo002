## 帽子を全員でそろえる

野球の試合で、チームのファンはそれぞれのチームの帽子をかぶっているが、帽子のかぶり方がバラバラで、帽子のひさしを普通に前にかぶっている人と、ひさしを後ろにかぶっている人とがいるとします。

ここで、下図の左が普通(前)で、右が逆(後)であると定義することにする。

＃図1

あなたは入り口の入場係で、並んでいる人たちが、普通かぶりか逆かぶりかの場合にだけ野球場に入場させることにします。かぶり方は向きを変えろとだけ命令することができます。

並んでいる人は、自分が何番目にいるのかはわかっています。一番前の位置は0、最後の人はn-1になります。そして、次のように命令できます。

- i番目の人は、帽子の向きを変えてください。
- i番目からj番目の人は、帽子の向きを変えてください。

課題は、命令回数を最小にすることです。次に例を示します。

＃図2

13人が位置0から位置12まで並んでいます。帽子は前向きが6人、後ろ向きが7人です。

例えば、次のようにすると命令回数は合計6回になります。最初の指示は次の通りです。

- 0番目の人は、帽子の向きを変えてください。

これを残りの1,5,9,1,10,12番の人に対しても支持します。

- 0番目から1番目の人は、帽子の向きを変えてください。
- 5番目の人は、帽子の向きを変えてください。
- 9番目から10番目の人は、帽子の向きを変えてください。
- 12番目の人は、帽子の向きを変えてください。

こうすることで、みんな帽子の向きが後ろ向きになります。


しかし、この例の場合には、次のようにすると、よりよくなります。

- 2番目から4番目の人は、帽子の向きを変えてください。
- 6番目から8番目の人は、帽子の向きを変えてください。
- 11番目の人は、帽子の向きを変えてください。

こうすると、みんなの帽子が前向きになります。

最小の指示回数でみんなの帽子の向きがそろうことが課題ですが、より高度な課題は、列を先頭から最後まで1回調べただけで最小回数の命令列を作ることができるかです。


